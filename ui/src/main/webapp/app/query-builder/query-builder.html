<!--
  ~ Copyright 2017 Crown Copyright
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<form ng-cloak>
    <md-toolbar>
        <div class="md-toolbar-tools">
            <h2 class="md-display-1">Build Operation</h2>
        </div>
    </md-toolbar>

    <md-dialog-content>
        <div class="md-dialog-content">
            <md-tabs md-dynamic-height md-border-bottom
                     md-selected="ctrl.step">
                <md-tab label="Choose operation"
                        ng-disabled="ctrl.step != 0">

                </md-tab>

                <md-tab label="Configure Operation"
                        ng-disabled="ctrl.step != 1">
                    <div ng-show="ctrl.selectedOp.input"></div>
                </md-tab>

                <md-tab label="Execute"
                        ng-disabled="ctrl.step != 2">
                    <p ng-show="!ctrl.expandQueryCounts && ctrl.selectedOp.arrayOutput">
                        Calculating number of results...
                    </p>

                    <div ng-show="ctrl.expandQueryCounts">
                        <p ng-show="ctrl.expandQueryCounts.limitHit">
                            The number of results may exceed
                            limit of {{settings.resultLimit}}.
                            Only the first {{settings.resultLimit}}
                            results will be used.
                        </p>

                        <p ng-show="!ctrl.expandQueryCounts.limitHit">
                            Number of results will be:
                            {{ctrl.expandQueryCounts.count}}
                        </p>
                    </div>
                </md-tab>
            </md-tabs>
        </div>
    </md-dialog-content>

    <md-dialog-actions layout="row">
        <span flex></span>
        <md-button ng-click="ctrl.cancel($event)">
            Cancel
        </md-button>
        <md-button ng-show="ctrl.step != 0"
                   ng-click="ctrl.goToPrevStep()">

            Back
        </md-button>
        <md-button id="build-query-next"
                   ng-show="ctrl.step == 1"
                   ng-click="ctrl.goToNextStep()">
            Next
        </md-button>
        <md-button id="build-query-execute"
                   ng-disabled="!(ctrl.step == 2)"
                   ng-click="ctrl.execute()"
                   ng-click="ctrl.execute()"
                   class="md-primary">
            Execute
        </md-button>
    </md-dialog-actions>
</form>