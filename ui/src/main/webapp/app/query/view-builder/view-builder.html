<md-card>
    <md-card-title>
        <md-card-title-text>
            <span class="md-headline">Add filters</span>
        </md-card-title-text>
    </md-card-title>

    <div layout="column" layout-padding>
        <div layout="row" layout-fill>
            <md-input-container flex>
                <label>Only include these entities</label>
                <md-select class="no-ellipsis" multiple ng-model="ctrl.viewEntities" md-on-close="ctrl.onElementGroupChange()">
                    <md-option ng-value="entity" ng-repeat="entity in ctrl.schemaEntities">{{entity}}</md-option>
                </md-select>
            </md-input-container>
            <md-input-container flex>
                <label>Only include these edges</label>
                <md-select class="no-ellipsis" multiple ng-model="ctrl.viewEdges" md-on-close="ctrl.onElementGroupChange()">
                    <md-option ng-value="edge" ng-repeat="edge in ctrl.schemaEdges">{{edge}}</md-option>
                </md-select>
            </md-input-container>
        </div>

        <md-list>
            <div ng-repeat="entity in ctrl.viewEntities track by entity" ng-if="ctrl.getEntityProperties(entity)">
                <md-subheader class="md-no-sticky">{{entity}} Filters</md-subheader>
                <md-list-item class="secondary-button-padding" ng-click="ctrl.editFilter(entity, 'entity', true, filter, $index)" ng-repeat="filter in ctrl.entityFilters[entity].preAggregationFilterFunctions track by $index">
                    <p> {{ctrl.createFilterLabel(filter, true)}} </p>
                    <md-icon class="md-secondary" md-svg-icon="delete" ng-click="ctrl.deleteFilter(entity, 'entity', true, $index)" aria-label="delete filter"></md-icon>
                </md-list-item>
                <md-list-item class="secondary-button-padding" ng-click="ctrl.editFilter(entity, 'entity', false, filter, $index)" ng-repeat="filter in ctrl.entityFilters[entity].postAggregationFilterFunctions track by $index">
                    <p> {{ctrl.createFilterLabel(filter, false)}} </p>
                    <md-icon class="md-secondary" md-svg-icon="delete" ng-click="ctrl.deleteFilter(entity, 'entity', false, $index)" aria-label="delete filter"></md-icon>
                </md-list-item>
                <md-list-item ng-click="ctrl.addFilters($event, entity, 'entity')">
                    <p>Add {{entity}} Filters</p>
                </md-list-item>
            </div>
            <div ng-repeat="edge in ctrl.viewEdges track by edge" ng-if="ctrl.getEdgeProperties(edge)">
                <md-subheader class="md-no-sticky">{{edge}} Filters</md-subheader>
                <md-list-item class="secondary-button-padding" ng-click="ctrl.editFilter(edge, 'edge', true, filter, $index)" ng-repeat="filter in ctrl.edgeFilters[edge].preAggregationFilterFunctions track by $index">
                    <p> {{ctrl.createFilterLabel(filter, true)}} </p>
                    <md-icon class="md-secondary" md-svg-icon="delete" ng-click="ctrl.deleteFilter(edge, 'edge', true, $index)" aria-label="delete filter"></md-icon>
                </md-list-item>
                <md-list-item class="secondary-button-padding" ng-click="ctrl.editFilter(edge, 'edge', false, filter, $index)" ng-repeat="filter in ctrl.edgeFilters[edge].postAggregationFilterFunctions track by $index">
                    <p> {{ctrl.createFilterLabel(filter, false)}} </p>
                    <md-icon class="md-secondary" md-svg-icon="delete" ng-click="ctrl.deleteFilter(edge, 'edge', false, $index)" aria-label="delete filter"></md-icon>
                </md-list-item>
                <md-list-item ng-click="ctrl.addFilters($event, edge, 'edge')">
                    <p>Add {{edge}} Filters</p>
                </md-list-item>
            </div>
        </md-list>
    </div>

</md-card>